<section class="wh-content-head">
  <h1>{{t 'wh.settings.team.invite.title'}}</h1>
</section>

<section class="wh-content-edit">

  <form class="wy-aligned">
    {{#if session.isDeployed}}
      <div class="wy-control-group">
        <label>{{t 'wh.settings.team.invite.instruction'}}</label>
        {{input type="email" required="required" value=inviteEmail }}
        <div class="wy-form-message">{{t 'wh.settings.team.invite.help'}}</div>
      </div>
      <div class="wy-btn-group">
        <button class="btn btn-neutral icon icon-user" {{ bind-attr disabled=isInvalidEmail }} {{ action "sendInvite" }}> {{t 'wh.settings.team.invite.action'}}</button>
      </div>
    {{else}}
      <div class="wy-alert wy-alert-danger">
        <div class="wy-alert-title">You need to deploy first</div>
        <p>Before you can add new members to your team you need to deploy the site onto the Internet. You can do this by running <code>wh deploy</code> in your local site directory. Then return to this page.</p>
      </div>
    {{/if}}


    {{#if error}}
      <div class="wy-alert wy-alert-warning">
        <div class="wy-alert-title">{{ error.code }}</div>
        {{error.message}}
      </div>
    {{/if}}

  </form>

</section>


<section class="wh-content-head wh-content-head-again">
  <h1>{{t 'wh.settings.team.current.title'}}</h1>
</section>
<section class="wh-content-subhead">
  {{t 'wh.settings.team.current.description'}}
</section>

<section class="wh-content-edit">

  <table class="wy-table wy-table-bordered-rows full-width">
    <thead>
      <tr>
        <th>{{t 'wh.settings.team.current.email'}}</th>
        <th>{{t 'wh.settings.team.current.permissions'}}</th>
      </tr>
    </thead>
    <tbody>

      {{#each user in allUsers }}
        <tr>
          <td>{{ user.email }}</td>
          <td>
            {{#if user.owner }}
            <div class="wy-dropdown wy-dropdown-bubble">
              <span class="btn btn-neutral icon icon-lock"> Owner <span class="caret"></span</span>
              <dl class="wy-dropdown-menu">
                <dd><a href="" {{ action "makeUser" user }}>Change to contributor</a></dd>
                <dd><a href="" {{ action "removeUser" user }}>Remove access entirely</a></dd>
              </dl>
            </div>
            {{/if}}
            {{#if user.user }}
              <div class="wy-dropdown wy-dropdown-bubble">
                <span class="btn btn-neutral icon icon-lock"> Contributor <span class="caret"></span</span>
                <dl class="wy-dropdown-menu">
                  <dd><a href="" {{ action "makeOwner" user }}>Change to owner</a></dd>
                  <dd><a href="" {{ action "removeUser" user }}>Remove access entirely</a></dd>
                </dl>
              </div>
            {{/if}}
            {{#if user.potential }}
              Waiting on verification (<a href="" class="icon icon-remove-sign" {{ action "removePotential" user }}> Cancel invite</a>)
            {{/if}}
          </td>
        </tr>
      {{/each}}
    </tbody>
  </table>
</section>
